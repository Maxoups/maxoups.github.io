<!DOCTYPE html>
<html lang="fr">

<head>
    <meta charset="UTF-8">
    <meta name="description" content="">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <!-- The above 4 meta tags *must* come first in the head; any other head content must come *after* these tags -->

    <!-- Title -->
    <title>Ancestral Cookbook | Menu</title>


    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/OwlCarousel2/2.3.4/assets/owl.carousel.min.css"/>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/OwlCarousel2/2.3.4/assets/owl.theme.default.min.css"/>

    <!-- Favicon -->
    <link rel="icon" href="img/core-img/favicon.ico">

    <!-- Core Stylesheet -->
    <link rel="stylesheet" href="style.css">
</head>


<body>
    <div id="website-header"></div>
        <!-- Recipe Slider -->
        <div class="container">
            <div class="row">
                <div class="col-12">
                    <div id="slider-container"></div>
                </div>
            </div>
        </div>

    <!-- ##### Breadcumb Area Start ##### -->
    <div class="breadcumb-area bg-img bg-overlay" style="background-image: url(img/bg-img/breadcumb3.jpg); margin-bottom: 60px;">
        <div class="container h-100">
            <div class="row h-100 align-items-center">
                <div class="col-12">
                    <div class="breadcumb-text text-center">
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- ##### Breadcumb Area End ##### -->

    <div class="container" style="margin-bottom: 60px; align-self: center;">
        <div class="results" style="display: flex; flex-wrap: wrap; justify-content: center; gap:40px;" id="results"></div>
    </div>


    <!-- ##### Breadcumb Area Start ##### -->
    <div class="breadcumb-area bg-img bg-overlay" style="background-image: url(img/bg-img/breadcumb3.jpg); margin-bottom: 60px;">
        <div class="container h-100">
            <div class="row h-100 align-items-center">
                <div class="col-12">
                    <div class="breadcumb-text text-center">
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- ##### Breadcumb Area End ##### -->


    <!-- jQuery (required by Owl Carousel) -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

    <!-- Owl Carousel JS -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/OwlCarousel2/2.3.4/owl.carousel.min.js"></script>


    <script src="js\PapaParse-5.0.2\papaparse.min.js"></script>
    <script src="js/recipe_functions.js"></script>

    <!-- jQuery-2.2.4 js -->
    <script src="js/jquery/jquery-2.2.4.min.js"></script>
    <!-- Popper js -->
    <script src="js/bootstrap/popper.min.js"></script>
    <!-- Bootstrap js -->
    <script src="js/bootstrap/bootstrap.min.js"></script>
    <!-- All Plugins js -->
    <script src="js/plugins/plugins.js"></script>
    <!-- Active js -->
    <script src="js/active.js"></script>

    <script>

    const resultsDiv = document.getElementById("results");

    function getRandomRecipe(type) {
        const filtered = recipesData.filter(r => r.Type === type);
        if (filtered.length === 0) return null;
        return filtered[Math.floor(Math.random() * filtered.length)];
    }

    function renderRandomMenu() {
        resultsDiv.innerHTML = "";
        const types = ["EntrÃ©e", "Plat", "Dessert"];
        types.forEach(type => {
            const recipe = getRandomRecipe(type);
            if (recipe) {
                let tags = recipe.Tags;
                if (typeof tags === "string") {
                    tags = tags.split(/[,;]\s*/);
                } else if (!Array.isArray(tags)) {
                    tags = [];
                }
                const div = document.createElement("div");
                div.className = "meal-item";
                div.onclick = () => window.open(`recipe.html?name=${recipe.ID}`, "_blank");
                const imgSrc = recipe.Images ? recipe.Images.split(",")[0] : recipe.Miniature;
                div.innerHTML = `
                    <img class="meal-img" src="${imgSrc}">
                    <h3 class="meal-title">${recipe.Titre}</h3>
                    <p class="meal-desc">${recipe.Cuistot}</p>
                    <p class="meal-desc">${tags.join(", ")}</p>
                    <p class="meal-item-button">RECETTE</p>
                `;
                resultsDiv.appendChild(div);
            }
        });
    }


    // Wait for recipesData to be loaded
    document.addEventListener("recipeDataLoaded", function () {
        renderRandomMenu();
    });

    // If data is already loaded
    if (typeof recipesData !== "undefined" && recipesData.length > 0) {
        renderRandomMenu();
    }
    </script>
</body>

</html>